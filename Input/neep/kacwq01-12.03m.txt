Kachemak Bay Research Reserve (KAC) NERR Water Quality Metadata
January - December 2003
Latest update:  September 27, 2004

1)	Data Set and Research Descriptors

Principal Investigators & Contact Persons

	Address:

	Kachemak Bay Research Reserve
	95 Sterling Highway, Suite 2
	Homer, AK 99603
	Tel: 907-235-4799 
	Fax: 907-235-4794

	Contact Persons:
	
	Scott Pegau:  Research Coordinator
	Email:  (Scott_Pegau@fishgame.state.ak.us)

2)	Entry Verification
	
For the Homer Dolphin Deep and Seldovia sites, the 15-minute data are uploaded 
to the PC from both the YSI Model 6200 Data Acquisition System via modem at 60 
minute intervals and the YSI 6600 datasonde upon recovery.  For the Port Graham 
and Bear Cove sites, the data are uploaded to the PC from the YSI 6600 
datasonde.  The text files are initially viewed with Ecowatch software and 
graphs are produced to look for suspect data, as may result from probe failure.  
Notes are made of any unusual data, and sensors are reconditioned as necessary.  

The text data files are run through a Matlab routine created by Scott Pegau for 
processing.  This routine is attached at the end of this report.   Although data 
are collected at 15-minute intervals, the routine is set to only output data 
every half-hour. The routine looks for data collected within 7.5 minutes of the 
desired output time.  Data that were recorded when the instruments were out of 
the water are deleted from the beginning and end of each record.  These data are 
identified by unusual depth and salinity data (usually near zero).  The routine 
outputs a data file listing the missing data points, fills all cells that do not 
contain data with periods (periods were later removed by the CDMO for data dissemination 
purposes and left blank), and finds and removes all data points that fall 
outside the range of what the data logger is designed to measure or are out of 
realistic ranges for Kachemak Bay.  The routine then processes the data through 
several filters to flag and remove suspect data points that are greater than 4 
standard deviations from data gathered in the 24 hour period surrounding the 
point.  It can remove the data point or just flag it as suspicious.   In 
addition, a graphing capability is included to produce single and multi-
parameter graphs on a monthly or yearly basis.  The routine outputs monthly 
files with column widths formatted to the correct number of decimal places based 
on YSI sensor specifications.

Anomalous data are evaluated to determine whether to flag or delete the suspect 
values.  Data are flagged if they fall outside the normal values seen at the 
site or outside the range of measurements and accuracy established for the 
sensors.  Data outside the "normal" range of water quality for a particular site 
were investigated for validity based on weather data, field observations, QC 
checks, and instrument diagnostics.  Data are deleted if anomalies are 
attributed to sensor malfunction or fouling of the sensors by aquatic 
organisms, debris, or sediment.  In addition, sensor readings that differ 
significantly  (>10%) from calibration standards suggest that the sensor was 
fouled during deployment.  After corrections are made to the text files and 
anomalies noted in the metadata report, the edited files are exported as tab 
delimited (*.txt) and sent to the CDMO.  Monthly raw (*.dat) files are also sent 
to the CDMO for archival.  Scott Pegau is responsible for these tasks.

3)	Research Objectives
	  
The YSI electronic data loggers are programmed to measure the water temperature, 
specific conductivity, dissolved oxygen, depth, pH, and turbidity conditions at 
15-minute intervals.  Two permanent and two seasonal instruments are located in 
Kachemak Bay.  The permanent sites are located on the northeast side of the bay 
at the end of the Homer spit and the second on the southwest side of the bay in 
Seldovia.  The seasonal moorings are located at endpoints of the Bay, Port 
Graham and Bear Cove, spanning a 40-mile distance.  
	
The circulation in Kachemak Bay is driven primarily by the 8-meter tidal flux.  
Regional circulation is characterized by generally cyclonic ocean currents in 
the Gulf of Alaska flowing onto the shelf off Cook Inlet.  Nutrient rich bottom 
water is upwelled and mixed with surface water.  These enriched waters may enter 
into Kachemak Bay, the inflow tending to stay along the southern shore flowing 
past the Port Graham and Seldovia instruments, while water flowing out of the 
bay stays along the Inner Bay and north shore, flowing past the Bear Cove and 
Homer Dolphin Deep instruments.  These trapped coastal flows separate the bay 
into two distinct ecosystems and the instruments are positioned to reflect this 
distinction. 
	
As the inflowing water proceeds up the bay, fresh water runoff from the 
surrounding ice fields and watersheds dilute the salinity and increase the 
sediment load in the path of the Bear Cove and then Homer Dolphin Deep 
instrument.  The inflowing water, in the path of the Port Graham and Seldovia 
instruments, therefore, initially supports a marine system while the north out 
flowing water of the Bear Cove, and Homer Dolphin Deep sites, is more estuarine.  
The Kachemak Bay water quality instruments capture this difference with 
deployments along the north and south shores.  These seasonal moorings monitor 
the degradation of the marine water along and across the axis of the bay.  These 
data will be used to supplement studies on primary productivity, larval 
distribution, settlement, recruitment, growth rates, community dynamics, and 
biodiversity in the bay.

4)	Research Methods
	
The permanent sites of Homer Dolphin Deep and Seldovia have YSI 6600 Sonde Data 
Loggers connected to 6200 Data Acquisition Systems that are used for data 
collection.  The Data Acquisition System is connected via modem to a computer at 
the Research Reserve.  The raw data is collected in 15-minute intervals, stored 
on the 6200 DCP and interrogated, or downloaded, by our office computer hourly.  
Both instruments are housed in ABS pipe mounted vertically on the ferry docks of 
Homer Dolphin Deep and Seldovia.  The pipes are positioned to ensure that the 
sensors are approximately 1 meter above the bottom.  
	
Port Graham and Bear Cove have YSI 6600 Sonde Data Loggers attached to 
seasonal moorings in an average of 10 meters (mean tide) of water and 
constructed to ensure the datalogger rested 1 meter above the bottom.   These 
moorings do not have a fixed location and therefore can change mean depth 
slightly between deployments.

Calibration and deployment occurred monthly using methods outlined in the YSI 
Operating and Service Manual.  After cleaning the dataloggers, the dissolved 
oxygen (DO) membrane is replaced and allowed to season in water-saturated air 
for 12 hours before the DO sensor is calibrated.  The pH, conductivity, depth, 
and turbidity sensors are calibrated using the following standards purchased 
from YSI (except depth): pH 7 and 10, conductivity standards of 50 mS/cm, 
respectively, and depth of 0.  Turbidity standard of 123 NTU is purchased from 
YSI.    
	
5)	Site Location and Character

Kachemak Bay is located approximately 150 miles south of Anchorage, on the 
western shore of the Kenai Peninsula.  Kachemak Bay, at 59.6º N and 151.5º W, is 
a temperate regional fjord with hydrographic conditions unique among the NERR 
system estuaries.  The tidal range of 8 meters is among the largest in the world 
and salinity ranges from near zero at stream mouths to 34.0 at the entrance to 
the inner Bay.  The bay is 24 miles wide at its mouth and approximately 36 miles 
long.   The head of Kachemak Bay is located to the northeast at the Fox River 
Flats, and the mouth lies to the southwest, along a line between Anchor Point 
and Point Pogibshi. Kachemak Bay is split into inner and outer Bays by the four 
mile long Homer Spit that extends into the Bay from the northern shoreline. The 
Kachemak Bay NERR comprises the entire inner Bay and the outer Bay.  Water flows 
between the inner and outer Bays through a narrow opening formed between the 
Spit and the southern shoreline. The Bay has an average depth of 25 fathoms (150 
feet) and a maximum of 100 fathoms (600 ft).  Fresh water introduced primarily 
by the Fox, Bradley, and Martin rivers and Sheep Creek at the head of the Bay, 
flows along the northwest shore of the inner Bay.  Peak release of fresh water 
from Bradley Creek alone results in flows of 1200 cubic feet per second. This 
peak flow occurs in conjunction with the warmest summer temperatures.

The Bear Cove data logger site is the eastern endpoint monitoring site and 
located on the southern side of the Inner Bay at 59.6833N, 151.1250W.  It is 
mounted 1 meter above the bottom in an average of 10 meters of water (mean tide) 
on a seasonal mooring.  The bottom habitat is predominantly sand.  Pollutants in 
the area are minimal.  The site is primarily influenced by the glacial fed 
Portlock and Grewingk Rivers. This innermost site has salinity ranges between 
20.1 and 31.9 ppt, due to the stratified nature of the water column.  The 
stratification is a result of freshwater runoff in the summer months.  During 
low tide, the instrument detects the upper section of the stratified water 
column and records low salinity levels.  With a tidal range of 8.2m, at high 
tide the instrument rests in the lower, more marine section of the stratified 
water column and higher salinities are recorded.  During the winter months, the 
system reverts more marine-like with little glacial runoff at a minimum and a 
near constant salinity of 32 ppt.  The access to Bear Cove is limited to boat 
travel, which is very weather dependent.  During the winter months, icing of the 
inner bay and strong winds from the east make access to the site impossible.  
Due to these factors, the deployment period for this site is limited to April 
through September.

The Homer Dolphin Deep YSI data logger site is located on the north side of 
Kachemak Bay at 59.6028ºN and 151.4081ºW.  Data for the Homer Dolphin Deepsite 
was collected from January through December 2003, at a depth 1 meter from the 
bottom in water fluctuating between 8.0 and 17.0 meters.  The bottom habitat is 
predominantly sand.  Pollutants in the area are from the excessive boat traffic 
at the entrance of the Homer harbor, and a nearby fish waste outfall line.  
Throughout the year, salinity has ranged from 20.5 to 31.7 ppt, as the 
instrument's location in the stratified water column is dependent on tide 
height, with a tidal range of 8.1m.  As with Bear Cove, it is predominately an 
estuarine environment during summer months when glacial runoff is highest and 
during the winter months, the system reverts more marine-like with glacial 
runoff at a minimum.  

The Seldovia YSI data logger site is located on the south side of Kachemak Bay 
at 59.4413ºN, 151.7186ºW, approximately 15 miles west of the Homer Dolphin Deep 
site and 11 miles east of the Bear Cove site.  As with the Homer Dolphin 
Deepsite, it is situated on the ferry terminal dock, one meter above the bottom 
and located in water fluctuating between 5 and 13.3 meters.  The access to 
Seldovia is limited to boat or air, as the site is located off the highway 
system.  The power and phone line connection are occasionally inoperative due to 
the remote location and position at the end of the power grid.  The bottom 
habitat is predominantly rocky substrate.  Pollutants in the area are minimal.  
Throughout the year, salinity has ranged from 30 to 35.9 ppt at this site with a 
tidal range of 8m. 

The Port Graham data logger site is the western endpoint monitoring site, 
located at the mouth of Kachemak Bay and the entrance to Cook Inlet at 59.3383ºN 
151.8917ºW.  It is situated off the coast of the native village of Nanwalek, and 
approximately 40 miles from the innermost site at Bear Cove.  All water entering 
the bay  is expected to pass by the Port Graham site, and is a true marine 
environment, with salinity ranging from 26.4 to 32.5 and a tidal range of 7.7m.  
It is mounted 1 meter above the bottom in 10 meters of water (mean tide) on a 
seasonal mooring.  The bottom habitat is predominantly rocky substrate and near 
a kelp bed.  The pollutants in the area are few.  The access to Port Graham is 
limited to boat travel, and is weather dependent.  During the winter months 
extreme weather conditions of the outer Bay and Cook Inlet make access to the 
site impossible.  Due to these factors, the deployment period at this site is 
limited to April through September.

6)	Data Collection Period

Monitoring at the Homer Dolphin Deep and Seldovia sites was continuous 
throughout 2003.  Monitoring at the Bear Cove site began on April 15, 2003 at 
18:00.  The data presented runs through September 26, 2003 at 07:16.  Monitoring 
at the Port Graham site was conducted between April 29 at 10:30 and September 
26, 2003 at 07:30.  Deployment and retrieval dates and times for following 
months are listed below:

Began		Ended		Sonde		Comments

Homer Dolphin Deep Site
12/10/02, 10:30	01/07/03, 14:30
01/07/03, 20:00	02/10/03, 08:30 Cortez		turb wiper not working
02/10/03, 17:30	03/17/03, 08:30	Neptune		none
03/17/03, 19:00	04/17/03, 09:00	Zeus		DO membrane wrinkled
04/17/03, 15:30	05/12/03, 10:00	Neptune		DO probes exchanged
05/12/03, 10:30	06/16/03, 08:30	Zeus		fish/inverts in sonde guard
06/16/03, 09:30	07/18/03, 13:00	Neptune		Chl wiper fouled w/bryzoans
07/18/03, 15:30	08/12/03, 23:00	Neptune		dead batt, hi DO chg
08/14/03, 13:00	09/22/03, 12:00	Calypso		repair turb probe, DO punct
09/22/03, 13:30	10/13/03, 09:00	Nansen		guard biofouled, DO punct
10/13/03, 09:30	11/12/03, 13:00	Amundsen	DO punct
11/12/03, 14:00	12/15/03, 10:00	Zeus		DO missing, repair turb
12/15/03, 10:30	01/19/04, 14:00	Amundsen	pH showed odd trend

Seldovia Site
12/09/02, 11:00	01/07/03, 10:30
01/07/03, 11:00	02/11/03, 10:30	Zeus		DO needs refurbished
02/11/03, 11:00	03/18/03, 08:30	Cortez		fouling, pH drift, hi DO Chg
03/18/03, 09:00	04/17/03, 09:30	Neptune		DO membrane wrinkled
04/17/03, 10:00	05/13/03, 16:30	Nautilus	new turb, added Chl probe
05/13/03, 18:00	06/03/03, 15:30	Neptune		retrieved early due to lo turb
06/03/03, 16:00	07/10/03, 14:00	Nautilus	Chl wiper over window
07/10/03, 13:30	08/16/03, 07:40	Zeus		DO probe heavily biofouled
08/17/03, 08:00	09/23/03, 11:36	Neptune		none
09/23/03, 09:00	10/14/03, 09:00	Kozloff		none
10/14/03, 10:00	11/13/03, 13:50	Neptune		none
11/13/03, 14:00	12/15/03, 12:45	Kozloff		DO needs refurbished
12/15/03, 12:45	01/20/04, 12:10	Neptune		has Chl probe	
				
Port Graham Site
04/29/03, 10:30	06/12/03, 08:00	Kozloff		none
06/12/03, 09:00	07/19/03, 10:00	Amundsen	new sonde
07/19/03, 10:30	08/22/03, 14:30	Kozloff		none
08/27/03, 12:30	09/24/03, 15:30	Amundsen	no post-cal

Bear Cove Site
04/15/03, 18:00	05/14/03, 10:30	Calypso		none
05/15/03, 09:00	06/10/03, 09:00	Calypso		pH10 mV out, SpC drift cal
06/11/03, 15:30	07/20/03, 11:30	Calypso		none
07/20/03, 12:00	08/22/03, 12:30	Amundsen	none
08/27/03, 08:30	09/24/03, 17:30	Nautilus	sensors cleaned then post-cal

7)	Distribution
	
According to the Ocean and Coastal Resource Management Data Dissemination Policy 
for the NERRS System-wide Monitoring Program, NOAA/ERD retains the rights to 
analyze, synthesize and publish summaries of the NERRS System-wide Monitoring 
Program data.  The PI retains the right to be fully credited for having 
collected and processed the data.  Following academic courtesy standards, the PI 
and NERR site where data were collected will be contacted and fully acknowledged 
in any subsequent publications in which any part of the data are used.  
Manuscripts resulting from this NOAA/OCRM supported research that are produced 
for publication in open literature, including refereed scientific journals, will 
acknowledge that the research was conducted under an award from the Estuarine 
Reserves Division, Office of Oceanic and Atmospheric Administration.  The data 
set enclosed within this package/transmission is only as good as the quality 
assurance and quality control procedures outlined by the enclosed metadata 
reporting statement.  The user bears all responsibility for its subsequent 
use/misuse in any further analyses or comparisons.  The Federal government 
does not assume liability to the Recipient or third persons, nor will the 
Federal government reimburse or indemnify the Recipient for its liability due to 
any losses resulting in any way from the use of this data.  

NERR water quality data and metadata can be obtained from the Research 
Coordinator at the individual NERR site, from the Data Manager at the 
Centralized Data Management Office (please see personnel directory under the 
general information link on the CDMO home page) and online at the CDMO home page 
http://cdmo.baruch.sc.edu.  Data are available in text tab-delimited format, 
Microsoft Excel spreadsheet format and comma-delimited format.

8)	Associated Researchers and Projects

Additional instruments deployed seasonally monitor the degradation of the marine 
water along and across the axis of the bay. These data are being used to 
supplement studies on sediment transport, primary productivity, larval 
distribution, settlement, recruitment, growth rates, community dynamics, and 
biodiversity in the bay.

The USGS, in conjunction with KBBR and the City of Homer, is conducting a 
sediment transport monitoring program at Munson Point in Homer.  This study uses 
an ARGUS camera array that collects hourly images of the beach area each day.  
To better understand the forces associated with the sediment transport a wave 
gauge is moored in 3 m MLLW of water.  A YSI 6600 sonde attached to this mooring 
for a portion of the summer deployment in order to determine the major source of 
water in this area.  More information about this project can be found at 
http://zuma.nwra.com/homer/

Another associated project is the non-indigenous species monitoring being 
conducted by the Smithsonian Environmental Research Center.  Settling plates 
were co-located with the SWMP instrument sites in Homer Dolphin Deep, Seldovia, 
and Port Graham.  Baited crab traps were also deployed in the Homer area.  For 
more information on this project contact Catherine E. deRivera 
[cderivera@earthlink.net].

II.	Physical Structure Descriptors

9)	Variable Sequence, Range of Measurements, Units, Resolution, and Accuracy:

YSI 6600 Datalogger Sonde
Variable      Range of Measurements          Resolution           Accuracy
Date          1-12, 1-31, 00-99 (Mo,Day,Yr)  1 mo, 1 day, 1 yr    NA
Time          0-24, 0-60, 0-60 (Hr,Min,Sec)  1 hr, 1 min, 1 s     NA
Temp               -5 to 45 (c)              0.01  C              +/-0.15C
Sp COND            0-100(mS/cm)              0.01mS/cm            +/-0.5% Of 
reading + 0.001mS/Cm
Salinity      0-70 Parts per thousand (ppt)  0.01 ppt             +/- 1% of 
Reading or 0.1 ppt, (whichever is greater)
DO            0-200 (% air saturation)       0.1% @air sat        +/-2% @air 
Saturation
DO            200-500 (% air saturation      0.1% @ air sat       +/- 6% @ 
Saturation
DO                 0-20 (mg/l)               0.01 mg/l            +/- 0.2mg/l
DO                 20-50 (mg/l)              0.01 mg/l            +/- 0.6mg/l
Depth (shallow)    0-9.1 (m)                 0.001m               +/- 0.018m
PH                 2-14 units                0.01 units           +/- 0.2units
Turb               0-1000 NTU                0.1 NTU              +/- 5% of 
Reading or 2 NTU (whichever is greater)

Data columns are separated by tabs.  Each file contains a two-line column header 
at the top of the page which identifies measurements and units for each column.
		
10)	Coded variable indicator and variable code definitions

File definitions:  YSI deployment site/file definition/month/year
(ex: sewq0103 = Seldovia water quality data from January 2003).

Sampling station:	Sampling site code:	Station code:
Bear Cove		BC			kacbcwq
Homer Dolphin Deep	HD			kachdwq
Seldovia		SE			kacsewq
Port Graham 		PG			kacpgwq

11)	Data anomalies

Note:  Only data collected within 7.5 minutes of the desired output time are 
provided in this dataset.  There were periods in the year where the YSI 6600 
sampled at unusual time intervals, 26 minute then 4 minute, instead of the 15-
minute intervals programmed.  This led to the blank lines in the data as no 
measurement was within 7.5 minutes of the desired sampling time.  A second data 
set is available that can fill in the gaps of this data.  For a more complete 
dataset please contact Scott Pegau at scott_pegau@fishgame.state.ak.us.

Note:	Outliers in the data are defined to be any point greater than 4 standard 
deviations from the mean of the 24-hour period surrounding that point.   
Turbidity outliers are most commonly related to fish and invertebrates within 
the sonde guard.

Note:   Between sonde rotations we typically encounter the following jumps in 
data as a result of calibration offsets and probe accuracy:  
	
	pH:		+/-  0.02
	DO %:		+/-  10
	DO Conc:	+/- 1 mg/l
	

January 1-31 2003


Homer Dolphin Deep
a) 	A data gap exists 01/07 15:00 -01/07 19:30 due to sonde replacement 
b)	Turbidity values were removed because of shutter problems 01/21 20:30-
01/31 23:30
c)	Turbidity outliers were removed by software at 01/05 00:30 and 01/07 
15:00.
d)	DO values were unusually noisy this month, but no single cause can be 
identified.
e)	The following DO percent outliers were not removed by software and should 
be considered suspicious data points.  01/01 19:00, 01/02 20:00, 01/03 20:30, 
01/07 15:00, 01/09 03:00, 03:30, 16:00, 01/10 09:00, 01/12 15:30, 01/14 
15:00, 21:00, 01/15 18:00, 19:00, 01/16 19:00, 01/17 20:00, 01/18 20:30, 
01/20 21:00, 21:30, 01/22 10:30, 01/23 11:30, 01/27 06:30, 01/31 07:30.
f)	The following DO concentration outliers were not removed and should be 
considered suspicious data points.  01/01 19:00, 01/07 15:00, 01/09 03:00, 
03:30, 16:00, 01/10 09:00, 01/12 15:30, 01/14 15:00, 21:00, 01/15 18:00, 
19:00, 01/16 19:00, 01/17 20:00, 01/20 21:00, 21:30, 01/22 10:30, 01/27 
06:30, 01/31 07:30.
g)	The following pH outliers were not removed and should be considered 
suspicious data points.  01/02 20:00, 01/03 20:30, 01/07 15:00, 01/10 20:00, 
01/12 15:30 and 16:00, 01/13 17:00, 01/14 17:00, 01/15 18:00, 01/16 19:00, 
0/17 20:00, 01/20 21:30 and 22:00, 01/21 22:00.

Seldovia
a)	Turbidity outliers were removed by software at 01/01 23:00, 01/03 19:00, 
01/07 02:30, 01/08 10:30, 01/09 01:00, 01/10 02:30, 01/11 06:30, 01/16 
00:00, 20:00, 01/24 01:00, 01/25 06:00, 01/28 04:30, 01/29 17:00, 01/30 
16:00, 01/31 06:30.
b)	DO values from 01/01 00:00 to 01/07 10:30 are suspiciously low.
c)	Outliers for DO percent and DO concentration recorded at 01/07 11:00 at 
time of deployment were not removed and should be considered suspicious.  A DO 
concentration outlier at 01/22 23:00 is also suspect.
d)	A pH outlier at 01/29 01:30 is suspect.


February 1-28, 2003

Homer Dolphin Deep
a)	A data gap exists 02/10 09:00 -02/10 17:00 due to sonde replacement
b)	Turbidity values were removed because of shutter problems 02/01 00:00 - 
02/10 08:30.
c)	Turbidity outliers were removed at 02/11 21:00, 02/15 18:30, 02/16 19:00 
02/22 23:30, 02/25 05:30
d)	The following DO percent outliers were not removed and should be 
considered suspicious.  02/03 21:30, 02/06 11:00, 02/08 00:00, 02/09 13:30, 
02/10 02:00, 14:30, 02/11 16:00, 02/13 18:00, 02/14 18:30, 02/25 19:00, 
02/27 17:30
e)	The following DO concentration outliers were not removed and should be 
considered suspicious.  02/03 21:30, 02/08 00:00, 02/09 13:30, 02/10 02:00, 
14:30, 02/11 16:00, 02/13 18:00, 02/18 22:00, 02/23 12:00
f)	The following pH outliers were not removed and should be considered 
suspicious.  02/08 00:00, 02/09 13:30, 02/11 16:30, 02/13 18:00, 18:30, 02/16 
19:00, 02/26 16:30.
       
Seldovia
a)	A high turbidity outlier was removed by software at 02/27 22:30.
b)	Other turbidity outliers were removed at 02/02 06:00, 19:00, 02/04 11:30, 
02/05 10:00, 02/22 19:30.
c)	The following DO percent outliers were not removed and should be 
considered suspect.  02/12 13:30, 02/13 03:00, 02/15 02:30, 02/17 02:00, 
4:30, 02/18 23:30, 02/19 22:30, 02/21 19:30, 02/23 15:30, 02/26 02:00, 02/27 
02:30, 06:30.
d)	DO data after 02/13 18:00 is unusually noisy.  The following DO 
concentration outliers were not removed and should be considered suspect.  
02/10 00:30, 02/12 13:30, 02/13 03:00, 02/15 02:30, 02/17 02:00, 14:30, 
02/18 23:30, 02/19 22:30, 02/21 06:00, 19:30, 02/23 15:30, 02/26 02:00, 
02/27 02:30, 06:30.
e)	The following pH outliers were not removed and should be considered 
suspect.  02/13 03:00, 22:00, 02/19 11:00.


March 1 - 31, 2003

Homer Dolphin Deep
a)	A data gap exists between 03/17 09:00 - 03/17 18:30 due to sonde 
replacement.   
b)	A high turbidity value was removed by software at 03/12 18:30.
c)	Turbidity outliers were removed at 03/01 14:00, 03/02 02:30, 03/03 1:30, 
03/05 09:00, 03/17 20:00, 03/20 14:30, 03/22 21:00, 03/25 05:30, 03/26 
15:00, 03/29 19:00, 03/30 11:30, 03/31 00:00.
d)	DO data was removed between 03/17 19:00 - 03/31 23:30 because of 
punctured DO membrane.
e)	pH outliers at 03/31 07:30 and 08:00 were not removed and are suspect.

Seldovia
a)	Turbidity outliers were removed by software at 03/10 05:30, 03/11 06:30, 
03/16 19:30, 03/26 11:00, 03/28 07:30, 03/31 12:00.
b)	The following DO percent and DO concentration outliers were not removed 
and should be considered suspect.  03/01 09:30, 03/02 01:00, 05:00, 03/07 
18:00, 03/14 22:00, 03/15 08:30, 03/16 02:00.
c) 	DO values 03/18 09:00 to the end of the month were removed because of a 
wrinkled DO membrane.
d)	The following pH outliers were not removed and are suspect.  03/01 09:30,  
03/02 01:00, 05:00, 03/10 12:30.
e)	An unexplained data gap occurred on 3/19 09:30.


April 1-30, 2003

Homer Dolphin Deep
a)	A data gap exists between 4/17 09:30 -15:00 due to sonde replacement.
b)	Turbidity outliers were removed by software at 04/02 08:30, 04/05 20:30, 
04/08 07:00, 04/09 06:00, 20:00, 04/25 17:30.
c)	DO data between 04/01 00:00 - 04/17 09:00 was removed due to punctured 
DO membrane
d)	A DO concentration outlier at 4/20 05:30 was not removed and is suspect.
e)	A pH outlier at 04/03 08:30 was not removed and is suspect.

Seldovia
a)	A high turbidity outlier was removed by software at 04/09 14:30.
b)	Other turbidity outliers were removed at 04/10 19:00, 04/16 08:00, 04/18 
14:00, 04/19 08:00, 04/29: 20:00.
c)	DO data was removed 04/01 00:00 - 04/17 09:30 due to wrinkled DO 
membrane.  DO values after this date have a suspicious decreasing trend.
d)	Data gaps caused by irregular sampling by the YSI 6600 occurred at 04/03 
13:30, 04/20 19:00, 04/21 09:00, 15:30, 18:30, 04/22 03:00, 04/23 00:00, 
19:00.
e)	Depth values were suspiciously low on 4/3 12:30 and 4/3 13:00.  

Bear Cove
a)	This mooring was not deployed until 04/15 18:00
b)	A high turbidity outlier was removed by software at 04/28 08:00.
c)	Other turbidity outliers were removed at 04/18 05:00, 07:30, 20:00, 04/30 
13:00.

Port Graham
a)	Turbidity outliers were removed by software at 04/30 01:30.
b)	DO percent and DO concentration outliers at 04/30 03:00 were not removed 
and are suspicious data points.
c)	This mooring was deployed 04/29 12:00


May  1-31, 2003

Homer Dolphin Deep
a)	Turbidity outliers were removed by software at 05/16 08:00, 05/22 02:00, 
05/23 2:30, 05/24 07:30, 05/26 09:00, 05/30 12:00, 05/31 13:00.
b)	A pH outlier at 05/10 08:00 was not removed and is suspect.
c)	DO membrane problem from 5/9 1:00-5/12 10:00; data deleted. 

Seldovia
a)	Turbidity outliers were removed by software at 05/01 17:00, 05/05 01:00, 
05/08 04:00, 05/10 17:00, 05/17 18:30, 05/19 08:00, 05/23 19:00, 
05/25 19:30, 05/27 3:30, 05/28 16:00, 05/29 11:30.
b)	DO values before 05/13 17:00 are suspiciously low.
c)	Data gaps occurred at 05/13 17:00-17:30 due to sonde replacement. 
d)	Data gaps due to irregular sampling by the YSI 6600 occurred at 05/15 
21:30, 05/19 00:30, 03:00, 08:30, 12:00, 14:30, 05/20 04:00, 07:00, 14:00, 05/21 
00:30-
01:00, 03:30, 04:30, 11:30, 14:30.

Bear Cove
a)	Turbidity outliers were removed by software at 05/02 02:30, 10:30, 05/08 
18:30, 22:30, 05/11 07:00, 05/12 14:30.
b)	A data gap occurred between 05/14 09:30 and 06/11 17:30 due to the data 
file never being downloaded.

Port Graham
a)	Turbidity outliers were removed by software at 05/02 14:00, 05/03 06:00, 
05/08 23:30, 05/10 04:00, 05/11 04:00, 05/14 23:00, 05/20 13:30, 05/21 
14:30, 05/24 02:00, 16:30, 05/25 12:00, 05/26 12:00, 05/27 05:30, 05/30 
09:30, 05/31 04:30, 19:30.
b)	The following DO percent and DO concentration outliers were not removed 
and are suspect.  05/13 20:00, 05/15 08:30, 09:30, 05/18 15:30.
c)	DO has a suspicious decreasing trend.


June 1-30, 2003

Homer Dolphin Deep
a)	Turbidity outliers were removed by software at 06/02 01:00, 13:30, 06/04 
03:30, 06/08 00:30, 21:00, 06/09 10:00, 06/15 21:30, 06/19 13:30, 06/22 
05:30, 06/25 17:30, 06/26 09:30, 19:00.
b)	Do percent and DO concentration outliers at 06/12 02:30 were not removed 
and are suspect.  A DO concentration outlier at 06/25 05:30 is also suspect.
c)	A data gap occurred at 06/16 09:00 due to sonde replacement.

Seldovia
a)	The sonde slipped out of the tube to the bottom of the bay.  DO and pH 
data seemed to be the most affected and accordingly the DO and pH data were 
removed between 06/15 02:00 and 06/30 23:30
b)	A high turbidity outlier was removed by software at 06/28 09:30.
c)	Other turbidity outliers were removed at 06/01 11:30, 06/03 04:00, 06/04 
14:30, 06/12 08:00, 06/14 05:00, 06/18 12:00, 06/20 12:00, 06/29 11:00.
d)	A pH outliers was not removed and is suspect.  06/14 12:30
e)	Unexplained data gaps occurred at 06/21 10:00, 06/21 12:30 - 06/22 14:00, 
06/22 15:00 - 06/23 00:30, 06/23 01:30 - 09:30, 06/23 10:30 - 12:30, 06/23 13:30 
- 06/24 08:30, 06/24 10:00 - 15:00, 06/24 16:30 - 17:00, 06/24 19:30 and 20:30.
f)	Salinity/specific conductivity values were suspiciously low on 6/3 16:30-21:30.  
g)	Salinity/specific conductivity values on 6/15 2:00 was suspiciously high. 
h)	Salinity/specific conductivity values on 7/6 14:00-16:00 was low due to fresh-
	water draining out of the embayment. 

Bear Cove
a)	A high turbidity outlier was removed at 06/17 13:00
b)	Other turbidity outliers were removed at 06/12 07:00, 06/15 17:30, 06/24 
07:00, 06/26 05:30, 06/27 04:00, 06/28 02:30, 05:00.
c)	A data gap occurred between 05/14 09:00:00 and 06/11 17:30:00 due to the 
data file never being downloaded.


Port Graham
a)	Turbidity outliers were removed at 06/01 08:30, 06/05 18:30, 06/08 02:30, 
06/09 1:00, 01:30, 06/13 17:00, 06/15 11:30, 06/17 05:00, 06/21 11:00, 06/24 
12:30, 06/25 5:00.
b)	A pH outlier at 06/08 15:00 was not removed and is suspect.
c)	DO values before 06/12 08:30 are suspiciously low.
d)	A data gap due sonde replacement occurred at 06/12 08:30.


July 1-31, 2003

Homer Dolphin Deep
a)	Turbidity outliers were removed at 07/01 12:30, 07/02 22:00, 07/05 12:30, 
07/07 04:00, 07/08 06:00, 07/09 21:30, 07/10 11:30, 07/11 06:00, 07/15 
11:00, 07/16 20:00, 07/17 14:30, 07/27 05:00, 07/29 06:00.
b)	The following DO percentage and DO concentration outliers were not 
removed and are suspect.  07/22 02:30, 07/23 04:00, 07/25 05:30, 06:00, 
07/26 06:00, 06:30, 07/27 19:30, 07/28 18:30, 07/29 08:00, 08:30.
c)	The following pH outliers were not removed and are suspect. 07/22 02:30, 
3:00, 07/23 04:00, 04:30, 07/25 05:30, 06:00, 07/26 06:00, 06:30, 07/28 
18:30, 19:30, 07/29 08:00.
d)	A data gap occurred at 07/18 13:30-15:00 due to sonde replacement.


Seldovia
a)	High turbidity values were removed at 07/24 04:00, 05:30.
b)	Other turbidity outliers were removed at 07/02 03:00, 07/11 03:30, 07/13 
06:30, 07/14 06:30, 07/15 03:00, 07/18 04:30, 07/21 12:30, 07/25 14:30, 
07/27 05:00.
c)	DO and pH values were removed because the sonde was in the bottom of the 
bay.  07/01 00:00-07/10 13:00.  
de)	DO values from 07/10 13:30 to the end of the month were removed due to a 
punctured DO membrane.

Bear Cove
a)	High turbidity outliers were removed at 07/27 05:00, 09:00, 10:00, 12:30, 
07/31 23:00.
b)	Other turbidity outliers were removed at 07/01 12:30, 07/02 14:00, 07/03 
22:30, 07/04 14:30, 07/05 04:00, 07/08 08:00, 07/10 02:00, 02:30, 23:30, 
07/11 20:00, 07/12 20:00, 07/19 20:00, 07/23 07:30, 07/29 09:30, 07/30 
10:30.
c)	DO percent and DO concentration outliers at 07/06 17:00 were not removed 
and are suspect.
d) 	A suspicious downward trend in DO data exists between 07/17 00:00 and 
07/20 11:30. This trend may be caused by biofouling. Data retained. 

Port Graham
a)	Turbidity outliers were removed at 07/01 12:00, 07/06 21:30, 07/12 04:00, 
07/16 16:30, 07/20 02:30, 07/26 10:00, 07/30 07:30.
b)	DO values starting at 07/19 10:30 are removed for the rest of the month 
due to membrane puncture.


August 1-31, 2003

Homer Dolphin Deep
a)	A high turbidity value was removed at 08/30 21:00.
b)	Other turbidity outliers were removed at 08/02 22:30, 08/04 09:30, 08/06 
16:30, 08/09 17:00, 08/11 01:30, 08/15 02:30, 08/29 05:30.
c)	DO percent and DO concentration outliers at 08/01 22:30 and 08/09 05:30 
were not removed and are suspect.  A DO concentration outlier at 08/05 01:00 
is also suspect.  DO data from 08/15 20:30 to the end of the month were removed 
because the DO membrane was punctured.
d)	The following pH outliers were not removed and are suspect.  08/09 05:30, 
08/12 08:30.
e)	A data gap occurred at 08/12 23:30-08/14 12:30 due to battery failure.


Seldovia
a)	Turbidity outliers were removed at 08/09 23:00, 08/17 09:00, 08/18 00:30, 
05:30, 08/22 06:30, 08/26 15:30, 08/27 05:00, 08/28 21:00.
b)	A pH outlier was not removed at 08/15 10:00 and is suspect.
c)	DO values were removed between 08/01 00:00 and 08/16 07:30 due to 
punctured membrane.

Bear Cove

a)	The following high turbidity values were removed by software.  08/01 
02:00, 08/02 07:00, 08/03 15:00, 16:00, 08/04 20:30, 08/05 00:30, 02:00, 07:00, 
19:00, 08/06 00:00, 05:00, 5:30, 23:30, 08/07 07:30, 12:30, 08/08 09:00, 08/09 
09:30, 08/10 04:00, 05:30, 08:30, 9:00, 10:30, 11:30, 08/11 00:30, 07:30, 
08/12 08:30, 12:30, 13:00, 17:30, 20:30, 22:00, 23:00, 08/13 02:00, 03:00, 
04:30, 08:00, 09:30, 10:00, 11:00, 12:00, 14:30, 22:00, 22:30, 23:30, 08/14 
00:00, 02:00, 16:00, 18:00, 20:00, 22:30, 23:30, 08/15 00:00, 00:30, 02:30, 
03:00, 07:30, 08:30, 11:30, 12:00, 12:30, 13:00, 15:00, 15:30, 19:30, 08/16 
01:00, 01:30, 03:30, 04:00, 04:30, 08:00, 09:30, 10:30, 17:00, 19:30, 23:30, 
08/17 00:00, 01:00, 01:30, 02:00, 02:30, 03:30, 04:00, 06:30, 10:00, 11:30, 
18:30, 22:00, 08/18 00:00, 03:30, 07:00, 12:30, 14:30, 08/19 01:30, 02:00, 
02:30, 03:30, 09:30, 15:00, 15:30, 16:00, 17:00.
b)	Other turbidity outliers were removed at 08/20 22:00, 08/28 12:30, 08/29 
23:00, 08/31 04:30.
c)	DO percent and DO concentration outliers at 08/05 05:30 were not removed 
and are suspect.
d)	An data gap due to sonde replacement occurred at 08/22 13:00-08/27 08:00.

Port Graham
a)	A high turbidity outlier was removed at 08/21 01:30.
b)	Other turbidity outliers were removed at 08/01 05:30, 08/02 04:30, 08/07 
1:00, 08/08 04:00, 08/10 04:00, 08/11 23:30, 08/21 17:30, 08/29 13:00, 08/31 
08:30, 19:30.
c)	DO values 08/01 00:00 - 8/22 14:30 are removed due to membrane puncture.
d)	DO percent and DO concentration outliers at 08/31 12:00 were not removed 
and are suspect.
e)	A data gap due to sonde replacement occurred at 08/22 15:00-08/27 12:00.


September 1-30, 2003

Homer Dolphin Deep
a)	No DO data was collected due to membrane punctures.
b)	Turbidity outliers were removed at 09/04 03:00, 09/05 16:00, 09/06 20:00, 
09/12 04:00, 09/15 03:30, 17:00, 09/22 12:00, 09/24 20:00, 09/30 00:00, 
21:30.
c)	The following pH outliers were not removed and are suspect.  09/06 05:00, 
09/19 02:00, 09/22 05:30, 09/29 10:00.
d)	Data gaps caused by irregular sampling by the YSI 6600 occurred at the 
following times.  09/03 22:00, 09/04 16:00, 20:30, 09/05 08:00, 09/06 07:30, 
14:30, 09/07 04:30-05:30, 09/08 01:30, 08:00, 20:00, 09/09 09:00, 14:00, 
16:00, 17:00, 18:30-19:30, 09/10 02:30, 17:30, 09/11 02:30, 03:30, 05:30, 11:00, 
12:00, 09/13 11:00, 15:00, 17:30, 09/14 06:30, 22:00, 09/15 03:00, 11:00, 
09/16 00:00, 07:00, 11:00-11:30, 16:30, 18:00, 19:00, 09/17 05:00, 09/18 
05:00, 14:30, 09/19 00:30, 09/20 02:30, 08:00, 12:30, 16:00, 09/21 15:30, 
22:00, 09/22 03:00.

Seldovia
a)	Turbidity outliers were removed at 09/01 00:00, 09/02 07:00, 09/03 01:00, 
09/06 00:00, 09/10 10:30, 09/18 20:30, 09/23 02:30, 09/26 20:30.
b)	A pH outlier was not removed at 09/11 14:00 and is suspect.
c) 	DO data on 09/03 11:00, 09/05 16:30 and 17:00, and 09/14 04:00 were 
flagged as outliers and should be considered suspect. Data retained. 

Bear Cove
a)	Turbidity outliers were removed at 09/02 01:00, 09/10 02:30, 09/12 22:00, 
09/13 5:00, 09/14 16:00, 09/22 09:30.
b)	A pH outlier at 09/06 04:30 was not removed and is suspect.
c)	DO data after 9/14 1300 is unusually low and is suspect.
d)	The mooring was retrieved 9/24 18:00

Port Graham
a)	Turbidity outliers were removed at 09/01 07:00, 14:30, 09/05 03:00, 09/06 
04:30, 09/07 22:00, 09/10 14:30, 09/14 17:00, 09/15 08:00, 03:30.


October 1-31, 2003

Homer Dolphin Deep
a)	No DO data was collected because of membrane punctures.
b)	A high turbidity value was removed at 10/15 01:30.
c)	A negative turbidity value and pH outlier were removed at 10/12 15:30.
d)	Other turbidity outliers were removed at 10/07 07:30, 10/15 15:00, 10/17 
01:00, 10/19 17:30, 10/23 06:00, 10/24 13:00, 13:30, 10/25 21:30, 10/28 
02:30, 10/30 01:30.
e)	The following pH outliers were not removed and are suspect.  10/03 01:30, 
10/07 05:30, 10/08 07:00, 10/10 21:00, 10/11 10:00, 10/13 22:00, 10/20 
03:30.

Seldovia
a)	A high turbidity value was removed at 10/26 16:00.
b)	Other turbidity outliers were removed at 10/04 19:00, 10/06 06:30, 10/11 
12:30, 10/13 15:30, 10/16 06:00, 10/17 12:30, 10/20 15:00, 10/28 06:00, 
06:30, 10/30 23:00.
c)	A pH outlier was not removed at 10/13 08:30 and is suspect.
d)	An data gap occurred at 10/14 09:30 due to sonde rotation.


November 1-30, 2003

Homer Dolphin Deep 
a)	No DO data was collected due to membrane punctures.
b)	High turbidity values were removed at 11/11 16:30, 11/29 01:30.
c)	Other turbidity outliers were removed at 11/02 16:00, 11/04 02:00, 11/05 
18:00, 11/10 23:00, 11/12 11:00, 11/21 18:30, 11/22 19:00, 11/28 04:30.
d)	The following pH outliers were not removed and are suspect.  11/03 10:00, 
11/04: 05:30, 11/05 18:30, 11/11 01:30, 11/19 06:00, 11/22 18:30.
e)	An data gap occurred at 11/12 13:30 due to sonde replacement.

Seldovia
a)	Turbidity outliers were removed at 11/04 08:00, 11/07 04:30, 11/08 05:30, 
11/11 00:30, 11/14 02:30, 11/16 00:30, 11/17 17:30, 11/19 19:30, 11/22 
22:00, 11/25 10:30, 11/27 00:30.
b)	pH outliers at 11/13 00:00, 00:30 were not removed and are suspect.


December 1-31, 2003

Homer Dolphin Deep
a)	DO data was removed between 12/01 00:00 - 12/15 10:00 because of 
membrane punctures.
b)	High turbidity outliers were removed at 12/01 03:00, 12/03 20:00, 12/04 
18:30, 12/05 06:00, 07:30, 12/06 00:00, 15:00.
c)	Other turbidity outliers were removed at 12/08 00:00, 17:00, 12/15 01:30, 
12/16 01:00, 15:30, 12/18 18:00, 12/24 14:00, 12/25 02:30, 12/26 06:30, 
07:00, 12/29 12:00.
d)	pH outliers at 12/08 08:00 and 12/19 17:00 were not removed and are 
suspect.

Seldovia
a)	Turbidity outliers were removed at 12/02 11:00, 12/05 11:00, 12/11 01:00, 
12/14 08:00, 12/20 14:00, 12/21 03:00, 12/27 17:00.
b)	A pH outlier at 12/28 07:30 was not removed and is suspect.


12)	Missing Data

	Missing data are denoted by a period in the data set. Periods were later 
removed for data dissemination purposes and left blank. Data are missing due to 
equipment failure where no probes deployed, maintenance/calibration of 
equipment, elimination of obvious outliers, or elimination of data due to 
calibration (both pre and post) problems.  For more details about missing data, 
contact the Research Coordinator at the Kachemak Bay Research Reserve.


13)	Post Deployment Information

End of Deployment Post-Calibration Readings in Standard Solutions:
** n/r = not recorded**

Site	Date		Conductivity	pH  	Turbidity	  DO (Air Sat)	Depth
			(Std:50.0)     (Std:7)  (Std:0)      	(Std:100%)	(m)
HO	01/07/03	50.69	     	7.25  	-1.1	       	 99.7		-0.022
	02/10/03	49.20	      	6.96  	-1.5	      	102.4		-
0.314
	03/17/03	49.49		7.05	0.3		111.3		0.240	
	04/17/03	49.60		7.12	1.0		101.2		-0.021  	
	05/12/03	49.83		6.87	-1.7		101.8	   	0.217	
	06/16/03	49.56		7.18	3.4		113.7		0.267
	07/18/03	50.24		7.23	-0.4		95.1		-03.12
	08/14/03	50.77		7.04	0.4		104.0		-0.045
	09/22/03	49.44		7.15	0.1		DO punct	0.125
	10/13/03	49.52		7.06	0.0		DO punct	-0.126
	11/12/03	50.02		6.90	0.2		DO missing	-0.292
	12/15/03	49.40		7.14	-0.1		106.5		-0.015		
		

SE	01/07/03	50.33		7.11	-0.4		113.0		0.363
	02/11/03	50.15		6.83	0.1		145.0		-0.119
	03/18/03	50.67		6.97	0.1		115.9		0.054
	04/17/03	48.30		7.21	2.0		100.0		-0.050
	05/13/03	50.72		6.80	-1.4		103.4		0.299
	06/03/03	48.47		7.07	38.1		-99.9		-0.146
	07/10/03	48.70		7.07	-0.1		58.0		-0.163
	08/16/03	49.20		7.31	-0.1		94.0		0.093
	09/23/03	48.46		7.07	0.2		90.8		0.083
	10/14/03	48.62		7.25	0.5		100.6		-0.146
	10/14/03	49.21		6.90	0.6		97.1		-0.241
	11/13/03	48.82		7.03	0.3		97.7		0.040
	11/13/03	49.33		7.06	0.3		100.8		-0.281
	12/15/03	49.76		7.06	1.4		152.0		-0.131
	12/15/03	48.90		7.18	0.2		138.6		-0.042

	
BC	04/15/03	48.58		7.24	1.8		112.0		-0.130
	05/15/03	48.90		6.98	1.0		105.1		0.044
	06/11/03	44.20		7.10	0.7		101.5		0.011
	07/20/03	49.41		7.11	1.1		109.6		0.029
	08/27/03	49.39		7.17	0.0		**		-0.087


PG	04/29/03	49.98		7.02	-0.04		72.8		0.046
			**		**	**		**		**
	06/12/03	49.47		7.15	3.5		104.9		0.093
	07/19/03	48.36		7.30	1.0		103.1		0.213
	08/27/03	**		**	**		**		**


14)	Other Remarks/Notes

a)	There were a few instances at this NERR site where turbidity recorded 
small negative values (-0001 and -0002). Because turbidity has a range of 
accuracy of +/-2 NTU, the technician did not edit or deleted these values in any 
way.
b)	Below is the matlab routine used to process water quality data.  An 
electronic copy is available from Scott Pegau at 
scott_pegau@fishgame.state.ak.us


% kbsonde.m  This routine converts the sonde data the CDMO format
% W. Scott Pegau  1/10/2003

%modifications as 1/22/04  -changed the program to  pull data within 15 minutes 
every 1/2 hour
% dissabled many filters to reduce confusion at CDMO

clear all

%Adding some operating triggers  1= yes  0=no
print_graphs=0;
process_monthly=0;
access_on=0;
chl_on=0;
fluor_on=0;
tmint=15;  % this is the binning time interval
tstp=30; %this is the time step
st_id='pgwq'; % the letter designator for the station


%set up variables and matrix needed to parse the data
date_time=[]; temper=[]; cond=[]; sal=[]; doperc=[]; doconc=[]; pH=[]; depth=[]; 
turb=[]; chl=[]; fluor=[]; errcode = [];
w=',';   
fignumber = 2;

% Read in all *.cdf comma delimited files

[file_list,n_file]=list_file('*.cdf'); %currently assumes that list_file.m and 
all *.cdf files 
are in the working directory

for i=1:n_file  %Begin loop to read in the data and append into a single matrix
   file_name_current_in=file_list(i,:);

   %chl_on=1;        % to re-turn on switches, if were turned off in prior loop
   %fluor_on=1;
   
   % remove empty characters from each filename
   fname_length=size(file_name_current_in,2);
   j=0;
   while file_name_current_in(1,fname_length-j)==' '
      file_name_current_in=file_name_current_in(1,1:fname_length-j-1);
   	j=j+1;   
   end
   
   
   fname_length=size(file_name_current_in,2); %let the user know the file being 
processed
   fprintf( '%s\n',file_name_current_in);
   
%Begin reading the data in
   fid=fopen(file_name_current_in);


%assume 2 lines of header in a .cdf file
HDR=fgetl(fid);  %DETERMINE THE NUMBER AND NAME OF VARIABLES 
HERE
units=fgetl(fid);  %DETERMINE THE UNITS OF THE VARIABLES HERE

%determine the variables in the file
    ww=findstr(HDR,w); %find commas in the header
    ww=[ww length(HDR)]; %accounts for a header beyond the last comma
    fprintf(' %d Variables in the file \r\n',length(ww))
%determine the variables of interest
  %this set of routines looks through the header to determine where the desired 
data is
    dc=findstr(HDR,'Date'); dcc=find(ww>dc); date_col=dcc(1);
    dc=findstr(HDR,'Time'); dcc=find(ww>dc); time_col=dcc(1);
    dc=findstr(HDR,'Temp'); dcc=find(ww>dc); temp_col=dcc(1);
    dc=findstr(HDR,'SpCond'); dcc=find(ww>dc); cond_col=dcc(1);
    dc=findstr(HDR,'Salinity'); dcc=find(ww>dc); sal_col=dcc(1);
    dc=findstr(HDR,'DO%'); if ~isempty(dc); dcc=find(ww>dc); doperc_col=dcc(1); 
end;
    dc=findstr(HDR,'DO %'); if ~isempty(dc); dcc=find(ww>dc); doperc_col=dcc(1); 
end;
    dc=findstr(HDR,'DO Conc'); dcc=find(ww>dc); doconc_col=dcc(1);
    dc=findstr(HDR,'Depth'); dcc=find(ww>dc); depth_col=dcc(1);
    dc=findstr(HDR,'pH'); dcc=find(ww>dc(1)); pH_col=dcc(1);
    dc=findstr(HDR,'Turbidity'); dcc=find(ww>dc); turb_col=dcc(1);
    dc=findstr(HDR,'Chloro'); 
        if isempty(dc); 
            no_chl=1;
            fprintf('No chlorophyll data.  Chlorophyll processing off. \r\n');
    else; 
            no_chl=0;
            dcc=find(ww>dc); chl_col=dcc(1);
        end;
    dc=findstr(HDR,'Fluor'); 
        if isempty(dc);
            no_fluor=1;
            fprintf('No fluorescence data.  Fluor turned off \r\n');
        else;
            no_fluor=0;
            dcc=find(ww>dc); fluor_col=dcc(1); 
        end;


    clear ww;

while 1; %read in each line of data and parse the data out
    a=fgetl(fid);
    if ~ischar(a), break, end;
    a=strcat(',',a,','); %add commas at the beginning and end of the string for 
parsing
    ww=findstr(a,w); %find commas
 
    %separate the date information 
    if strcmp(a(ww(date_col)+1),'"'); %this if statement is necessary if a file 
was 
manipulated in excel prior to being input into this routine
    d=datenum(a(ww(date_col)+2:ww(date_col+1)-
2))+datenum(a(ww(time_col)+2:ww(time_col+1)-2));  %reads in date and time 
columns
    date_time=[date_time;d]; %store as number in a vector
    else
    d=datenum(a(ww(date_col)+1:ww(date_col+1)-
1))+datenum(a(ww(time_col)+1:ww(time_col+1)-1));  %reads in date and time 
columns
    date_time=[date_time;d]; %store as number in a vector
    end
        
     %read in the data
     tt=str2num(a(ww(temp_col)+1:ww(temp_col+1)-1)); temper=[temper;tt];
     tt=str2num(a(ww(cond_col)+1:ww(cond_col+1)-1)); cond=[cond;tt]; 
     tt=str2num(a(ww(sal_col)+1:ww(sal_col+1)-1)); sal=[sal;tt];
     tt=str2num(a(ww(doperc_col)+1:ww(doperc_col+1)-1)); doperc=[doperc;tt];
     tt=str2num(a(ww(doconc_col)+1:ww(doconc_col+1)-1)); doconc=[doconc;tt];
     tt=str2num(a(ww(depth_col)+1:ww(depth_col+1)-1)); depth=[depth;tt];
     tt=str2num(a(ww(pH_col)+1:ww(pH_col+1)-1)); pH=[pH;tt];
     tt=str2num(a(ww(turb_col)+1:ww(turb_col+1)-1)); turb=[turb;tt];
     if chl_on 
         if no_chl;
             tt=NaN;
             chl=[chl;tt];
         else;
             tt=str2num(a(ww(chl_col)+1:ww(chl_col+1)-1)); 
             chl=[chl;tt]; 
         end;
     end;
    if fluor_on; 
        if no_fluor;
            tt=NaN;
            fluor=[fluor;tt];
        else;
             tt=str2num(a(ww(fluor_col)+1:ww(fluor_col+1)-1)); 
             fluor=[fluor;tt]; 
        end;
    end;
     
     
     
 end;
  fclose(fid);

end

%SORT THE DATA BY DATE

tdata=[date_time temper cond sal doperc doconc depth pH turb chl ]; % removed 
fluoro
ttdata=sortrows(tdata,1);
date_time=ttdata(:,1); temper=ttdata(:,2); cond=ttdata(:,3); sal=ttdata(:,4);
doperc=ttdata(:,5); doconc=ttdata(:,6); depth=ttdata(:,7); pH=ttdata(:,8);
turb=ttdata(:,9); 
if chl_on; chl=ttdata(:,10); end;  
if fluor_on; fluor=ttdata(:,11); end;


%BEGIN CLEANING UP THE DATA

%throw out obvious bad or missing data
%the limits are in part from CDMO absolute rejection criteria
%I trust the cals on temperature the most so if it is out the rest of the data 
is assumed to 
be garbage
good_data=find(temper>-5&temper<40&cond>10&depth>0);  %finding "good" 
temperature and conductivity data (conductivity test to ensure in water)

    date_time=date_time(good_data); %only keep "good" data
    temper=temper(good_data);
    cond=cond(good_data);
    sal=sal(good_data);
    doperc=doperc(good_data);
    doconc=doconc(good_data);
    depth=depth(good_data);
    pH=pH(good_data);
    turb=turb(good_data);
    if chl_on; chl=chl(good_data); end;
    if fluor_on; fluor=fluor(good_data); end;

    
%identify gaps caused by bad or missing data
   kk=find(diff(date_time)>(tstp*.0104166667/15+.001));
   fnamr=fopen('report.txt','w');
    for i=1:length(kk);
        fprintf(fnamr,'Data gap between %s %s 
\r\n',datestr(date_time(kk(i))),datestr(date_time(kk(i)+1)));
    end
 


%print the time covered by this data
    fprintf('\r\n Begining date %s \r\n',datestr(date_time(1)));
    fprintf('End date %s \r\n',datestr(date_time(end)));

%PROBABLY WANT PLOTS OF LARGE DATA SET TO IDENTIFY PROBLEMS

%process complete months of data

[Y,M,D,H,MI,S]=datevec(date_time); %separate out the date info
%begin looping over years
     for I=Y(1):Y(end);       %loop over years
        yyy=find(Y==I);
        %plot the years worth of data to look for oddities
        yjd=date_time(yyy)-datenum(I-1,12,31);
        stdate=min(yjd); endate=max(yjd);
        figure;
        subplot(7,1,1); plot(yjd,temper(yyy),'k'); axis([stdate endate -2 15]); 
ylabel('Temperature');
        subplot(7,1,2); plot(yjd,sal(yyy),'k'); axis([stdate endate 22 33]); 
ylabel('Salinity');
        subplot(7,1,3); plot(yjd,doperc(yyy),'k'); axis([stdate endate 80 130]); 
ylabel('DO 
percent');
        subplot(7,1,4); plot(yjd,depth(yyy),'k'); axis([stdate endate 2 17]); 
ylabel('Depth');
        subplot(7,1,5); plot(yjd,pH(yyy),'k'); axis([stdate endate 7.5 8.5]); 
ylabel('pH');
        subplot(7,1,6); plot(yjd,turb(yyy),'k'); axis([stdate endate -100 
200]);ylabel('Turbidity');
        if chl_on; subplot(7,1,7); plot(yjd,chl(yyy),'k'); axis([stdate endate -
10 
30]);ylabel('Chlorophyll'); xlabel('Julian day'); end; 
        set(gcf,'Paperposition',[.5 .5 7 10])
        year_title=num2str(Y(yyy(1))); subplot(7,1,1); title(year_title);
        pause(5);

        if print_graphs; print; end
        
        
        for J=1:12;  %loop over months
            mmm=find(M(yyy)==J); %find data within a month
            if ~isempty(mmm)&process_monthly; %continue if data in the month is 
available
                mmm=mmm+yyy(1)-1; %adjust month pointer to full data set
                
 ftemper=[]; fcond=[]; fsal=[]; fdoperc=[]; fdoconc=[]; fdepth=[]; fpH=[]; 
fturb=[]; 
fchl=[]; fjd=[]; % ffluor=[];


                    mdate_time=date_time(mmm); %pull out the single month of 
data to work 
with
                    mtemper=temper(mmm);
                    mcond=cond(mmm);
                    msal=sal(mmm);
                    mdoperc=doperc(mmm);
                    mdoconc=doconc(mmm);
                    mdepth=depth(mmm);
                    mpH=pH(mmm);
                    mturb=turb(mmm);
                    if chl_on; mchl=chl(mmm); end;
                    if fluor_on; mfluor=fluor(mmm); end;
                    mjd=mdate_time-datenum(I-1,12,31);
                    
                    %save monthly data in matlab file
                    fnm=datestr(datenum(I,J,1),2);
                    fnam=strcat(st_id,fnm(1:2),fnm(7:8));
                    fprintf('Year is %u and month is %u 
\r\n',Y(mmm(1)),M(mmm(1)));
                    if chl_on; eval(['save ' fnam ' mjd mdate_time mtemper mcond 
msal 
mdoperc mdoconc mdepth mpH mturb mchl']); 
                    else eval(['save ' fnam ' mjd mdate_time mtemper mcond msal 
mdoperc 
mdoconc mdepth mpH mturb']);
                    end;
                    
                    %loop through the month averaging available data into 
proscribed time step 
intervals and filling gaps with NaN
                    %also applying a filter to the data
                    date_int=tstp*.0104166667/15; %interval that averages are 
collected
                    t_int=tmint*.0104166667/15; %interval around the time step 
within which 
data is averaged
                    fnamo=strcat(fnam,'.txt');
                    fido=fopen(fnamo,'w');
                    fprintf(fido,'Date \t Time \t Temp \t SpCond \t Sal \t DO \t 
DO \t Depth \t pH 
\t Turb \r\n');
                    fprintf(fido,'MM/DD/YYYY \t hh:mm:ss \t C \t mS/cm \t ppt \t 
percent \t 
mg/L \t m \t \t NTU \r\n');
 
                      if access_on;
                            % open output files and put headers on
                            fida1=fopen(strcat(fnam,'temperAccess.txt'),'w');
                            fida2=fopen(strcat(fnam,'CondAccess.txt'),'w');
                            fida3=fopen(strcat(fnam,'SalinityAccess.txt'),'w');
                            fida4=fopen(strcat(fnam,'DOAccess.txt'),'w');
                            fida5=fopen(strcat(fnam,'DepthAccess.txt'),'w');
                            fida6=fopen(strcat(fnam,'pHAccess.txt'),'w');
                            fida7=fopen(strcat(fnam,'TubidityAccess.txt'),'w');
                            if chl_on; 
fida8=fopen(strcat(fnam,'ChlAccess.txt'),'w'); end;
                            fprintf(fida1, 'StationCode \t TimeCode \t Depth \t 
Temp(C) \r\n');
                            fprintf(fida2, 'StationCode \t TimeCode \t SpCond 
\r\n');
                            fprintf(fida3, 'StationCode \t TimeCode \t Salinity 
\r\n');
                            fprintf(fida4, 'StationCode \t TimeCode \t DOperc \t 
DOConc \r\n');
                            fprintf(fida5, 'StationCode \t TimeCode \t Depth 
\r\n');
                            fprintf(fida6, 'StationCode \t TimeCode \t pH 
\r\n');
                            fprintf(fida7, 'StationCode \t TimeCode \t Turbidity 
\r\n');
                            if chl_on; fprintf(fida8, 'StationCode \t TimeCode 
\t Chl \r\n'); end;
                      end;
                        
                    for II=datenum(I,J,1):date_int:datenum(I,J+1,1);
                        cdate=datestr(II,23); ctime=datestr(II,13);
                        cjd=II-datenum(I-1,12,31);
                        ll=find(mdate_time>(II-
t_int/2)&mdate_time<(II+t_int/2)); %find data +- 
1/2 the time interval minutes from desired output time
                        lm=find(mdate_time>(II-.5)&mdate_time<(II+.5)); %find 
data within 12 
hours for filtering purpose (should expand to allow data out of the month)
                        if isempty(ll); %missing data is listed as NaN
                            ctemper=NaN; ccond=NaN; csal=NaN; cdoperc=NaN; 
                            cdoconc=NaN; cdepth=NaN; cpH=NaN; cturb=NaN; 
cchl=NaN;
                            %save data in CDMO formatted tab delimited text 
files
                            fprintf(fido,'%s \t %s \t %04.1f \t %06.2f \t %04.1f 
\t %05.1f \t %04.1f 
\t %05.2f \t %04.1f \t %05.0f \r\n',cdate, ctime, ctemper,ccond, csal, cdoperc, 
cdoconc, 
cdepth, cpH, cturb);

                            %save filtered data to compare against raw data
                            ftemper=[ftemper;ctemper]; fcond=[fcond;ccond]; 
fsal=[fsal;csal]; 
fdoperc=[fdoperc;cdoperc]; fjd=[fjd;cjd];
                            fdoconc=[fdoconc;cdoconc]; fdepth=[fdepth;cdepth]; 
fpH=[fpH;cpH]; 
fturb=[fturb;cturb]; fchl=[fchl;cchl]; %ffluor=[ffluor;ffluor];

                        else;  %use nanmean so that filters can be put in place 
before this step

                            
                            ctemper=nanmean(mtemper(ll)); 
ccond=nanmean(mcond(ll)); 
csal=nanmean(msal(ll)); cdoperc=nanmean(mdoperc(ll)); 
                            cdoconc=nanmean(mdoconc(ll)); 
cdepth=nanmean(mdepth(ll)); 
cpH=nanmean(mpH(ll)); cturb=nanmean(mturb(ll)); 
                            if chl_on; cchl=nanmean(mchl(ll)); end;
%                            if fluor_on; cfluor=nanmean(mfluor(ll)); end;
                            
                            %ADDING INDIVIDUAL COMPONENT FILTERS  
                            %BEWARE OF ALL FILTERS
                               %absolute data rejection filters as specified by 
CDMO or more 
restrictive based on realistic values
                            if ctemper<-2|ctemper>25; ctemper=NaN; 
errcode=[errcode; 1,II];  end; 
%CDMO -5 to 45
                            if ccond<0|ccond>100; ccond=NaN; errcode=[errcode; 
2,II]; 
end;%CDMO cond 0 to 100
                            if csal<10|csal>36; csal=NaN; errcode=[errcode; 
3,II]; end; %CDMO 
salinity 10 to 36
                            if cdoperc<0|cdoperc>200; cdoperc=NaN; cdoconc=NaN; 
errcode=[errcode; 4, II]; end; %CDMO dopercent 0 to 200
                            if cpH<4|cpH>12; cpH=NaN; errcode=[errcode; 5,II]; 
end; %CDMO 
pH 2 to 14
                             
                            if cturb>400; cturb=NaN; errcode=[errcode;6,II]; 
end;    
                            if cturb<-2; cturb=NaN; errcode=[errcode;7,II]; end;
                            if chl_on&cchl>50; cchl=NaN; errcode=[errcode;8 
,II]; end;
                            if chl_on&cchl<0; cchl=NaN; errcode=[errcode; 9,II]; 
end;
%                            if fluor_on&cfluor<0; cfluro=NaN; 
fprintf(fnamr,'negative 
fluorescence on %s \r\n',datestr(II)); end;
                            
                               %outlier filter; the filter looks for data within 
12 hours of the data 
point and removes the data point if it is 
                               % more than 4 standard deviations from the mean 
(not applied to 
temperature and salinity because of the two layer system)
                      
                               %1/22/04  many of these filters commented out to 
ease getting 
CDMO approval
                               %I am reporting the out data as suspicious
                               
                            if 
cdoperc>(nanmean(mdoperc(lm))+4*nanstd(mdoperc(lm)))|cdoperc<(nanmean(mdoperc(
lm))-4*nanstd(mdoperc(lm))); 
                            %    cdoperc=NaN;
                                errcode=[errcode; 10,II];
                            end;
                            if 
cdoconc>(nanmean(mdoconc(lm))+4*nanstd(mdoconc(lm)))|cdoconc<(nanmean(mdoco
nc(lm))-4*nanstd(mdoconc(lm)));
                            %    cdoconc=NaN; 
                                errcode=[errcode; 11,II];
                            end;
                            if 
cpH>(nanmean(mpH(lm))+4*nanstd(mpH(lm)))|cpH<(nanmean(mpH(lm))-
4*nanstd(mpH(lm))); 
                            %    cpH=NaN; 
                                errcode=[errcode; 12,II];
                            end;
                            if 
cturb>(nanmean(mturb(lm))+4*nanstd(mturb(lm)))|cturb<(nanmean(mturb(lm))-
4*nanstd(mturb(lm))); 
                                cturb=NaN; 
                                errcode=[errcode; 13 ,II];
                            end;
                            if 
chl_on&(cchl>(nanmean(mchl(lm))+4*nanstd(mchl(lm)))|cchl<(nanmean(mchl(lm))-
4*nanstd(mchl(lm)))); 
                                cchl=NaN; 
                                errcode=[errcode; 14,II];
                            end;
%                            if 
fluor_on&(cfluor>(nanmean(mfluor(lm))+4*nanstd(mfluor(lm)))|cfluor<(nanmean(mchl
(
lm))-4*nanstd(mfluor(lm)))); 
%                                cfluor=NaN; 
%                                fprintf(fnamr,'Fluorescence outlier on %s 
\r\n',datestr(II));
%                            end;
                            
                            %Print out the data in CDMO format
                            fprintf(fido,'%s \t %s \t %04.1f \t %06.2f \t %04.1f 
\t %05.1f \t %04.1f 
\t %05.2f \t %04.1f \t %04.0f \r\n',cdate, ctime, ctemper, ccond, csal, cdoperc, 
cdoconc, 
cdepth, cpH, cturb);
                            
                            %save filtered data to compare against raw data
                            ftemper=[ftemper;ctemper]; fcond=[fcond;ccond]; 
fsal=[fsal;csal]; 
fdoperc=[fdoperc;cdoperc]; fjd=[fjd;cjd];
                            fdoconc=[fdoconc;cdoconc]; fdepth=[fdepth;cdepth]; 
fpH=[fpH;cpH]; 
fturb=[fturb;cturb]; 
                            if chl_on; fchl=[fchl;cchl]; end;
 %                           if fluor_on; ffluor=[ffluor;cfluor]; end;
                            
                        %SET UP TO OUTPUT ACCESS DATA FILES   
                        % only want filtered data without any NaNs
                         if access_on;
                            [AY,AM,AD,AH,AMI,AS]=datevec(II); % develop the time 
code
                            AYS = num2str(AY);
                            AJDS = num2str(floor(II-datenum(I-1,12,31)));
                            if length(AJDS)== 1; AJDS=strcat('00',AJDS); end;
                            if length(AJDS)== 2; AJDS=strcat('0',AJDS); end;
                           
                            AHS = num2str (AH);
                            if length(AHS) ~= 2;
                                AHS = strcat('0', AHS);
                            end;
                            AMS = num2str (AMI);
                            if length(AMS) ~= 2;
                                AMS = strcat('0', AMS);
                            end;
                                
                            TimeCode = strcat(AYS(3:4),AJDS,AHS,AMS);
                                %output the Access data
                                    accessdepth='Low';
                                    if ~isnan(ctemper); fprintf(fida1,'%s \t %s 
\t %s \t %04.2f 
\r\n',st_id, TimeCode, accessdepth, ctemper); end;
                                    if ~isnan(ccond); fprintf(fida2,'%s \t %s \t 
%06.2f \r\n',st_id, 
TimeCode, ccond); end;                                                                      
                                    if ~isnan(cdoperc); fprintf(fida4,'%s \t %s 
\t %05.1f \t %04.1f 
\r\n',st_id, TimeCode, cdoperc, cdoconc);  end;                                  
                                    if ~isnan(csal); fprintf(fida3,'%s \t %s \t 
%04.1f \r\n',st_id, 
TimeCode, csal); end;                                   
                                    if ~isnan(cdepth); fprintf(fida5,'%s \t %s 
\t %05.2f \r\n',st_id, 
TimeCode, cdepth);  end;                                  
                                    if ~isnan(cpH); fprintf(fida6,'%s \t %s \t 
%04.1f \r\n',st_id, 
TimeCode, cpH); end;                                    
                                    if ~isnan(cturb); fprintf(fida7,'%s \t %s \t 
%05.0f \r\n',st_id, 
TimeCode, cturb); end;                                    
                                    if ~isnan(cchl); fprintf(fida8,'%s \t %s \t 
%05.0f \r\n',st_id, 
TimeCode, cchl); end;                                    
  %                                  if ~isnan(cfluor); fprintf(fida9,'%s \t %s 
\t %05.0f \r\n',st_id, 
TimeCode, cfluor); end;                                    
                                end;
                         
                        end; 
                    end;
                     fclose(fido);
                     if access_on;
                         
fclose(fida1);fclose(fida2);fclose(fida3);fclose(fida4);fclose(fida5);fclose(fid
a6);
                         fclose(fida7);
                     end;
                     if chl_on; fclose(fida8); end;
   %                  if fluoro_on; fclose(fida8); end;



                           
                    %plot the monthly data 
                    
                    figure(fignumber);
                    subplot(3,1,1); plot(mjd,mdepth,'-k',fjd,fdepth,'.r'); 
ylabel('Depth');
                    subplot(3,1,2); plot(mjd,mtemper,'-k',fjd,ftemper,'.r'); 
ylabel('Temperature');
                    subplot(3,1,3); plot(mjd,msal,'-k',fjd,fsal,'.r'); 
ylabel('Salinity'); xlabel('Julian 
Day');
                    set(gcf,'Paperposition',[.5 .5 7 10])
                    subplot(3,1,1); title(fnam);
                    plotfnam1= strcat(fnam, '1');
                    if print_graphs; print; end;
                    fignumber=fignumber+1;
                    
                    figure(fignumber);
                    subplot(4,1,1); plot(mjd,mdoperc,'-k',fjd,fdoperc,'.r'); 
ylabel('DO percent');
                    subplot(4,1,2); plot(mjd,mpH,'-k',fjd,fpH,'.r'); 
ylabel('pH');
                    subplot(4,1,3); plot(mjd,mturb,'-k',fjd,fturb,'.r'); 
ylabel('Turbidity');
                    if chl_on; subplot(4,1,4); plot(mjd,mchl,'-
k',fjd,fchl,'.r'); 
ylabel('Chlorophyll'); xlabel('Julian Day'); end;
                    set(gcf,'Paperposition',[.5 .5 7 10])
                    subplot(4,1,1); title(fnam);
                    plotfnam2= strcat(fnam, '2');
                    if print_graphs; print; end;
                    fignumber=fignumber+1;
                    pause(5)
                 
            end
        end
     end;
            for errloop=1:14;       
                % Finds all errcodes of each number
                kk=find(errcode(:,1)==errloop);
                % Assigning messages for error codes
                if errloop==1; errprint='Temperature Out of Range';end;
                if errloop==2; errprint='Sp Cond Out of Range';end;
                if errloop==3; errprint='Salinity Out of Range';end;
                if errloop==4; errprint='DO Percent Out of Range';end;
                if errloop==5; errprint='pH  Out of Range';end;
                if errloop==6; errprint='High Turbidity';end;
                if errloop==7; errprint='Negative Turbidity';end;
                if errloop==8; errprint='High Chlorophyll';end;
                if errloop==9; errprint='Negative Chlorophyll';end;
                if errloop==10; errprint='DO Percent Outlier';end;
                if errloop==11; errprint='DO Conc Outlier';end;
                if errloop==12; errprint='pH Outlier';end;
                if errloop==13; errprint='Turbidity Outlier';end;
                if errloop==14; errprint='Chlorophyll Outlier';end;
                % Prints error code message
                fprintf(fnamr,'\r\n %s %s \r\n',errprint, ':');
                % Cycles through errors of same errcode
                for count=1:length(kk);

                    if count == 1;
                        fprintf(fnamr, '\r\n %s: ', 
datestr(errcode(kk(count),2),6));
                      if length(kk)==1;
                          fprintf(fnamr, '%s, ', 
datestr(errcode(kk(count),2),15));
                      else
                        if (errcode(kk(count+1),2)-errcode(kk(count),2)) > 
(tmint*.0104166667/15+.001);
                          fprintf(fnamr, '%s, ', 
datestr(errcode(kk(count),2),15));
                        else
                          begseq=errcode(kk(count),2); %start of sequence
                          begcount=count;
                        end
                    end
                        
                    elseif count==length(kk);
                       if (errcode(kk(count),2)-errcode(kk(count-1),2)) < 
(tmint*.0104166667/15+.001); %is sequential with previous
                           endseq=errcode(kk(count),2);
                              if begcount>1&(floor(begseq)-
floor(errcode(kk(begcount-1),2)))<1;
                                if (floor(endseq)-floor(begseq))>=1;
                                    fprintf(fnamr,'%s - %s: 
%s',datestr(begseq,15), datestr(endseq,6), 
datestr(endseq,15));
                                else;
                                    fprintf(fnamr,'%s - %s, 
',datestr(begseq,15), datestr(endseq,15));
                                end;
                              else
                                if (floor(errcode(kk(count),2))-
floor(errcode(kk(count-1),2)))>=1;
                                    fprintf(fnamr,'\r\n %s: %s, 
',datestr(errcode(kk(count),2),6), 
datestr(errcode(kk(count),2),15));
                                else;
                                    fprintf(fnamr,'%s, ', 
datestr(errcode(kk(count),2),15));
                                end;

                              end;
                       elseif  (floor(errcode(kk(count),2))-
floor(errcode(kk(count-1),2)))>1;
                           fprintf(fnamr,'\r\n %s: %s, 
',datestr(errcode(kk(count),2),6), 
datestr(errcode(kk(count),2),15));
                       else;
                           fprintf(fnamr,'%s, ', 
datestr(errcode(kk(count),2),15));
                       end;
                    else;
                        if (errcode(kk(count),2)-errcode(kk(count-1),2)) < 
(tmint*.0104166667/15+.001); %is sequential with previous
                            if (errcode(kk(count+1),2)-errcode(kk(count),2)) > 
(tmint*.0104166667/15+.001); %check if at end of sequence
                                endseq=errcode(kk(count),2);
                             if begcount>1;
                              if (floor(begseq)-floor(errcode(kk(begcount-
1),2)))<1;
                                if (floor(endseq)-floor(begseq))>=1;
                                    fprintf(fnamr,'%s - %s: %s, ', 
datestr(begseq,15), datestr(endseq,6), 
datestr(endseq,15));
                                else;
                                    fprintf(fnamr,'%s - %s, ', 
datestr(begseq,15), datestr(endseq,15));
                                end;    
                              else;   
                                if (floor(errcode(kk(count),2))-
floor(errcode(kk(count-1),2)))>=1;
                                    fprintf(fnamr,'\r\n %s: %s - %s: %s, 
',datestr(begseq,6), 
datestr(begseq,15),datestr(endseq,6), datestr(endseq,15));
                                else;
                                    fprintf(fnamr,'\r\n %s: %s - %s, ', 
datestr(begseq,6), 
datestr(begseq,15),datestr(endseq,15));
                                end;
                              end;
                             else;
                                if (floor(endseq)-floor(begseq))>=1;
                                    fprintf(fnamr,'\r\n %s: %s - %s: %s, 
',datestr(begseq,6), 
datestr(begseq,15),datestr(endseq,6), datestr(endseq,15));
                                else;
                                    fprintf(fnamr,'%s - %s, ', 
datestr(begseq,15),datestr(endseq,15));
                                end;
                             end;
                            end;
                        else; %not in sequence with previous
                            if (errcode(kk(count+1),2)-errcode(kk(count),2)) < 
(tmint*.0104166667/15+.001); %check if at begining of sequence
                                begseq=errcode(kk(count),2); %start of sequence
                                begcount=count;
                            else;
                                if (floor(errcode(kk(count),2))-
floor(errcode(kk(count-1),2)))>=1;
                                    fprintf(fnamr,'\r\n %s: %s, 
',datestr(errcode(kk(count),2),6), 
datestr(errcode(kk(count),2),15));
                                else;
                                    fprintf(fnamr,'%s, ', 
datestr(errcode(kk(count),2),15));
                                end;
                            end;
                        end;
                    end;
                end;
            end;                   
               
       fclose(fnamr);
